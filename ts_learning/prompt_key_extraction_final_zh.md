# 表格字段提取指令（强制校验版）

**[最高指令]** 你的唯一任务是生成一个纯净的JSON数组。**最终输出的JSON数组长度，必须与根据规则计算出的`预期数量`完全相等。** 严禁输出任何解释或代码。

**[必须遵循的工作流程]**
1.  **识别规则**: 根据HTML结构，找到下方唯一匹配的规则。
2.  **计算数量**: 执行该规则下的【第一步：计算】，得出`预期数量`。
3.  **执行提取**: 执行【第二步：提取】，确保生成了`预期数量`个对象。
4.  **输出结果**: 输出最终的、数量绝对正确的JSON数组。

---
### **伪代码规则**

#### **规则1: 如果表格包含 `data-diagonal-split-type` 属性**
-   **【第一步：计算】**
    -   `预期数量` = (`总列数` - 1) * (`总行数` - 1)。
    -   **你必须生成一个包含`预期数量`个对象的JSON数组。**
-   **【第二步：提取】**
    -   `行标题` = 第2行第1个单元格的文本。
    -   遍历第2行从第2个单元格开始的**所有单元格** (`目标单元格`):
        -   `id` = `目标单元格`的`data-cell-id`
        -   `key` = `行标题` + `_` + `目标单元格`正上方(第1行同列)单元格的文本

#### **规则2: 如果表格只有1行**
-   **【第一步：计算】**
    -   `预期数量` = `总列数` / 2。
    -   **你必须生成一个包含`预期数量`个对象的JSON数组。**
-   **【第二步：提取】**
    -   遍历表格中第2、4、6...（所有偶数位置）的 `目标单元格`:
        -   `id` = `目标单元格` 的 `data-cell-id` 属性
        -   `key` = `目标单元格`左侧紧邻的`<td>`的文本

#### **规则3: 如果表格是2行，且第2行只有第1个单元格有内容**
-   **【第一步：计算】**
    -   `预期数量` = (`总列数` - 1)。
    -   **你必须生成一个包含`预期数量`个对象的JSON数组。**
-   **【第二步：提取】**
    -   `行标题` = 第2行第1个单元格的文本。
    -   遍历第2行从第2个单元格开始的**所有单元格** (`目标单元格`):
        -   `id` = `目标单元格` 的 `data-cell-id` 属性
        -   `key` = `行标题` + `_` + `目标单元格`正上方(第1行同列)单元格的文本

#### **规则4: 如果表格是2行，且第2行所有单元格都为空**
-   **【第一步：计算】**
    -   `预期数量` = `总列数`。
    -   **你必须生成一个包含`预期数量`个对象的JSON数组。**
-   **【第二步：提取】**
    -   遍历第2行的**所有单元格** (`目标单元格`):
        -   `id` = `目标单元格` 的 `data-cell-id` 属性
        -   `key` = `目标单元格`正上方(第1行同列)单元格的文本

#### **规则5: 如果表格首行有 `colspan` 且值大于2**
-   **【第一步：计算】**
    -   `预期数量` = 表格中所有内容为空的`<td>`的总数。
    -   **你必须生成一个包含`预期数量`个对象的JSON数组。**
-   **【第二步：提取】**
    -   遍历表格中的**每一个**内容为空的`目标单元格`:
        -   `id` = `目标单元格` 的 `data-cell-id` 属性
        -   `key` = 在**同一行**中，`目标单元格`左侧最近的那个有文本的`<td>`的文本

#### **规则6: 如果表格首行有 `colspan="2"`**
-   **【第一步：计算】**
    -   `预期数量` = `总行数` - 1。
    -   **你必须生成一个包含`预期数量`个对象的JSON数组。**
-   **【第二步：提取】**
    -   遍历从第2个`<tr>`开始的**每一个**`数据行`:
        -   `目标单元格` = `数据行`中的第2个 `<td>`
        -   `id` = `目标单元格` 的 `data-cell-id` 属性
        -   `key` = `数据行`中第1个`<td>`的文本
