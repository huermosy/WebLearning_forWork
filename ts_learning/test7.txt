# 表格字段提取指令（脑神经视觉模型）

## 任务描述
你需要像人眼一样，扫描HTML表格并提取所有需要替换的字段。
**注意：只要属于数据区的数据单元格（即非标题行、非标题列），无论单元格是否有内容，都必须提取。**
输出为一个JSON数组，JSON串外加上目标格子的数量，不需要有任何解释。

## 表格结构说明
就像人眼能快速识别特殊结构，请特别注意：

特殊情况：表格名称行在第一行，独占多列。
### 对角线表头:
- 特征：左上角单元格有data-diagonal-split-type属性
- 行标题在每行第一格
- 列标题在每列第一行
- 其余均为数据单元格
- key = 行标题_列标题

### 单行表格:
- 特征：表格只有一行
- 目标格子是第2、4、6...位置的单元格为数据单元格
- 每个目标格子的key是其左侧单元格的文本

### 普通表格:
- 特征：第一列和第一行通常是标题
- 行标题可能存在每行第一格
- 列标题可能存在该列第一行
- 其余均为数据单元格
- key = 行标题_列标题/行标题/列标题


请遵循：先按规则思考，不要急于输出结果，对每个步骤完成后自查校验下结果是否正确。最重要的是：我在步骤中标明``需要自查``部分
## 人眼扫描表格的四步法

### 第一步：定位目标格子
正如人眼自然会被表格中的"空白处"吸引，你首先需要：
- 找出表格中所有属于数据区的数据单元格，即非标题区、非描述区、不是行/列头的单元格，无论是否有内容，这些都要作为"目标格子"。
- 不要遗漏任何一个数据单元格（包括已填和空白），如果有遗漏重新该步骤，``需要自查``空白单元格的id是否有被你提取，如果没有重新执行该步骤。

### 第二步： 寻找表格名称行列
人眼遍历表格结构，记录是否有表格名称行列：
- 你需要检查整个表格是否有表格名称行列。表格名称行列不能作为列标题或行标题

### 第三步：寻找标签（行标题或者列标题）
对每个"目标格子"，人眼会自动寻找"说明它是什么"的标签：
- 首先看它**上方标题单元格（通常是第一行，如果有表格标题行列则可能在第二行，如果只有表格标题则说明没有列标题）** 作为标签-列标题
- ``需要自查``表格名称不能作为标签-列标题
- 如以上步骤没有找到合适的列标题，则说明没有列标题！
- 再先看它左边是否有文字，左边的文字通常是这个格子的标签-行标题
- 对特殊表格（如对角线表头），同时需要行标题和列标题
- 记录下列标题和行标题

### 第四步：校验标签
人脑和眼睛校验第二步和第三步数据，确认标签获取是否正确：
- 如果列标题和表格标题相同，则说明第三步执行有误，请重新执行第三步
- 结果的可能情况： 1. 列标题和行标题同时存在 2.只存在行标题或者列标题


### 第五步：组合关键词
人脑会自然地将标签组合成有意义的关键词：
- 如果找到了两个标签（行标题+列标题），就用下划线连接：行标题_列标题，
- 如果只有一个标签（左侧或上方），注意排除表格名称行的情况。就直接用这个标签作为key，不需要下划线
- 标签会将原有内容全部替换

### 第六步：记录结果
为每个"目标格子"创建一条记录，包含两个信息：
- id: 格子的唯一标识（data-cell-id属性值）
- key: 第三步得到的关键词
- 需自查data-cell-id是否存在，且输出的json串根据data-cell-id从小到大排列

**注意：只要属于数据区的数据单元格（即非标题行、非标题列），无论单元格是否有内容，都必须提取。**
